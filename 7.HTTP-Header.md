
# 📑 HTTP 헤더 개요
## HTTP 헤더
### 용도
- HTTP 전송에 필요한 모든 부가 정보를 가지고 있음
- 표준 헤더가 너무 많고, 필요시 임의의 헤더 추가 가능

### 과거의 HTTP (RFC2616)
#### HTTP Header
- General 헤더 : 메시지 전체에 적용되는 정보
- Request 헤더 : 요청 정보
- Response 헤더 : 응답 정보
- Entity 헤더 :  엔티티 바디 정보 (ex. Content-Type : text/html, Content-Length: 3423)

#### HTTP Body
- 메시지 본문은 엔티티 본문을 전달하는데 사용
- 엔티티 본문은 요청이나 응답에서 전달할 실제 데이터
- **엔티티 헤더**는 **엔티티 본문**의 **데이터를 해석할 수 있는 정보**를 제공
  - Content-Type, Content-Length


> ### But..
> - ~~1999년 RFC2616 폐기~~
> - 2014년 RFC7230 ~ 7235 등장


## HTTP BODY
> 🎈 **RFC723x 변화**
> - 엔티티(Entity) -> 표현(Representation)
> - Representation = representation Metadata + Representation Data
> - 표현 = 표현 메타데이터 + 표현 데이터

 message body - RFC7230(최신)
 - 메시지 본문을 통해 표현 데이터 전달
 - 메시지 본문 = payload
 - **표현** : 요청이나 응답에서 **전달할 실제 데이터**
 - **표현헤더** : 표현 데이터를 해석할 수 있는 정보 제공

# ✨ 표현
 - Content-Type: 표현 데이터의 형식 (html, JSON)
 - Content-Encoding : 표현 데이터의 압축 방식 
 - Content-Language: 표현 데이터의 자연 언어
 - Content-Length: 표현 데이터의 길이 [Payload 헤더]
 `표현 헤더는 전송, 응답을 둘 다 사용`
 
 
## Content-Type
**표현 데이터의 형식 설명**
- 미디어 타입, 문자 인코딩
  - text/html; charset=utf-8
  - application/json
  - image/png

## Content-Encoding
**표현 데이터 인코딩**
- 표현 데이터를 압축하기 위해 사용
- 데이터를 전달하는 곳에서 gzip과 같이 압축 후 인코딩 헤더 추가
- 데이터를 읽는 쪽에서 인코딩 헤더의 정보로 압축 해제

> 데이터를 보내는 곳에서 어떻게 압축했는지 알려주고  
> 그 내용을 토대로 읽는 쪽에서 압축을 해제!

## Content-Language
- 표현 데이터의 자연 언어(en, ko, en-US)를 표현
- 클라이언트가 언어를 변경하는 작업

## Content-Length
**표현 데이터의 길이**
- 바이트 단위
- Transfer-Encoding을 사용하면 사용하면 안됨!

# 💡 콘텐츠 협상(Content negotiation)
**클라이언트가 선호하는 표현 요청**
> 클라이언트가 원하는 표현으로 서버가 전달

- Accept: 클라이언트가 선호하는 미디어 타입 전달
- Accept-Charset: 클라이언트가 선호하는 문자 인코딩
- Accept-Encoding: 클라이언트가 선호하는 압축 인코딩
- Accept-Language: 클라이언트가 선호하는 자연 언어

**`협상 헤더는 요청시에만!`**

## Accept-Language 적용 전
![](https://velog.velcdn.com/images/f1v3/post/e4860cf2-d0c9-4a5a-8732-236caca1c8ec/image.png)

서버는 기본 값인 영어로 응답을 해준다

## Accept-Language 적용 후 
![](https://velog.velcdn.com/images/f1v3/post/3e194f19-d7aa-41ab-b0d1-c22091b1b93b/image.png)  
기본 언어가 영어지만 한국어를 지원하기 때문에 한국어로 응답

## Accept-Language 복잡한 예시
![](https://velog.velcdn.com/images/f1v3/post/a281d0b9-e3ab-46b9-a5d9-10bf3c70501e/image.png)  

독일어보다는 영어를 원하지만 기본 언어인 독일어를 보냄

> 우선순위가 필요하다!

## 협상과 우선순위1 

-  **Quality Values(q)** 값 사용
- 0 ~ 1, **클수록 높은 우선순위**
- 생략하면 1

> ![](https://velog.velcdn.com/images/f1v3/post/9ae99aee-afbe-42f4-a0ff-3942d4d82a18/image.png)
> 위와 같이 보내게 된다면 어떻게 될까?
>![](https://velog.velcdn.com/images/f1v3/post/780e834d-8926-465f-aafa-54857a7b1fbd/image.png)

**구글에 hello라고 쳤을 때**  
![](https://velog.velcdn.com/images/f1v3/post/bba78853-7774-44f0-ab8d-d06c2fe119bc/image.png)


## 협상과 우선순위2
- 구체적인 것이 우선한다.
- Accept: **text/*, text/plain, text/plain;format=flowed, \*/\***

## 협상과 우선순위3
- 구체적인 것을 기준으로 미디어 타입을 맞춘다.
- **Accept: text/*;q=0.3, text/html;q=0.7, text/html;level=1,
 text/html;level=2;q=0.4, \*/\*;q=0.5**  
   ![](https://velog.velcdn.com/images/f1v3/post/96f6a648-c8e0-492d-af53-8b4b8cfcbc54/image.png)
